'SET foreign_key_checks=0;

--
-- Table: `accepted_reports`
--
CREATE TABLE `accepted_reports` (
  `id` varchar(255) NOT NULL auto_increment,
  `status` varchar(255) NULL,
  INDEX `pk_id` (`id`),
  PRIMARY KEY (`id`)
);

--
-- Table: `distributions`
--
CREATE TABLE `distributions` (
  `id` integer NOT NULL auto_increment,
  `name` varchar(255) NOT NULL,
  `version` varchar(255) NOT NULL,
  INDEX `pk_id` (`id`),
  PRIMARY KEY (`id`)
) ENGINE=InnoDB;

--
-- Table: `environments`
--
CREATE TABLE `environments` (
  `id` integer NOT NULL auto_increment,
  `language_id` integer NOT NULL,
  `system_id` integer NOT NULL,
  `toolchain`  NULL,
  `user_agent` varchar(255) NULL,
  INDEX `pk_id` (`id`),
  INDEX (`language_id`),
  INDEX (`system_id`),
  PRIMARY KEY (`id`),
  CONSTRAINT `environments_fk` FOREIGN KEY (`language_id`) REFERENCES `languages` (`id`),
  CONSTRAINT `environments_fk_1` FOREIGN KEY (`system_id`) REFERENCES `systems` (`id`)
) ENGINE=InnoDB;

--
-- Table: `perl 5s`
--
CREATE TABLE `perl 5s` (
  `archname` varchar(255) NOT NULL,
  `build` varchar(255) NULL,
  `commit_id` varchar(255) NULL,
  `id` integer NOT NULL auto_increment,
  `name` enum(\'Perl 5\', \'Perl 6\') NOT NULL,
  `variables`  NULL,
  `version` varchar(255) NOT NULL,
  INDEX `pk_id` (`id`),
  PRIMARY KEY (`id`)
) comment=\'Language data for Perl 5 reports\';

--
-- Table: `perl 6s`
--
CREATE TABLE `perl 6s` (
  `archname` varchar(255) NOT NULL,
  `backend`  NULL,
  `build` varchar(255) NULL,
  `id` integer NOT NULL auto_increment,
  `implementation` varchar(255) NULL,
  `name` enum(\'Perl 5\', \'Perl 6\') NOT NULL,
  `variables`  NULL,
  `version` varchar(255) NOT NULL,
  INDEX `pk_id` (`id`),
  PRIMARY KEY (`id`)
) comment=\'Language data for Perl 6 reports\';

--
-- Table: `prerequisites`
--
CREATE TABLE `prerequisites` (
  `have` varchar(255) NULL,
  `id` integer NOT NULL auto_increment,
  `name` varchar(255) NOT NULL,
  `need` varchar(255) NOT NULL,
  `phase` varchar(255) NOT NULL,
  INDEX `pk_id` (`id`),
  PRIMARY KEY (`id`)
);

--
-- Table: `releases`
--
CREATE TABLE `releases` (
  `author` varchar(255) NULL,
  `dist` varchar(255) NULL,
  `fail` integer NULL,
  `id` integer NOT NULL auto_increment,
  `na` integer NULL,
  `pass` integer NULL,
  `unknown` integer NULL,
  `version` varchar(255) NULL,
  INDEX `pk_id` (`id`),
  PRIMARY KEY (`id`)
) comment=\'A summary of test reports for a single CPAN release\';

--
-- Table: `reports`
--
CREATE TABLE `reports` (
  `comments`  NULL,
  `created` varchar(255) NULL,
  `distribution_id` integer NOT NULL,
  `environment_id` integer NOT NULL,
  `id` varchar(255) NOT NULL auto_increment,
  `reporter_id` integer NOT NULL,
  `result_id` integer NOT NULL,
  INDEX `pk_id` (`id`),
  INDEX (`distribution_id`),
  INDEX (`environment_id`),
  INDEX (`reporter_id`),
  INDEX (`result_id`),
  CONSTRAINT `reports_fk` FOREIGN KEY (`distribution_id`) REFERENCES `distributions` (`id`),
  CONSTRAINT `reports_fk_1` FOREIGN KEY (`environment_id`) REFERENCES `environments` (`id`),
  PRIMARY KEY (`id`),
  CONSTRAINT `reports_fk_2` FOREIGN KEY (`reporter_id`) REFERENCES `reporters` (`id`),
  CONSTRAINT `reports_fk_3` FOREIGN KEY (`result_id`) REFERENCES `results` (`id`)
) ENGINE=InnoDB comment=\'CPAN Testers report\';

--
-- Table: `report_summaries`
--
CREATE TABLE `report_summaries` (
  `date` varchar(255) NULL,
  `dist` varchar(255) NULL,
  `grade_id` integer NULL,
  `guid` varchar(255) NULL,
  `id` integer NOT NULL auto_increment,
  `osname` varchar(255) NULL,
  `osvers` varchar(255) NULL,
  `perl` varchar(255) NULL,
  `platform` varchar(255) NULL,
  `reporter` varchar(255) NULL,
  `version` varchar(255) NULL,
  INDEX `pk_id` (`id`),
  INDEX (`grade_id`),
  CONSTRAINT `report_summaries_fk` FOREIGN KEY (`grade_id`) REFERENCES `grades` (`id`),
  PRIMARY KEY (`id`)
) ENGINE=InnoDB comment=\'Flattened summary data from the test report data structure\';

--
-- Table: `reporters`
--
CREATE TABLE `reporters` (
  `email` varchar(255) NOT NULL,
  `id` integer NOT NULL auto_increment,
  `name` varchar(255) NULL,
  INDEX `pk_id` (`id`),
  PRIMARY KEY (`id`)
) ENGINE=InnoDB;

--
-- Table: `results`
--
CREATE TABLE `results` (
  `duration` integer NULL,
  `failures` integer NULL,
  `grade_id` integer NOT NULL,
  `id` integer NOT NULL auto_increment,
  `output_id` integer NOT NULL,
  `skipped` integer NULL,
  `tests` integer NULL,
  `todo`  NULL,
  `warnings` integer NULL,
  INDEX `pk_id` (`id`),
  INDEX (`grade_id`),
  INDEX (`output_id`),
  CONSTRAINT `results_fk` FOREIGN KEY (`grade_id`) REFERENCES `grades` (`id`),
  PRIMARY KEY (`id`),
  CONSTRAINT `results_fk_1` FOREIGN KEY (`output_id`) REFERENCES `test_outputs` (`id`)
) ENGINE=InnoDB;

--
-- Table: `systems`
--
CREATE TABLE `systems` (
  `cpu_count` varchar(255) NULL,
  `cpu_description` varchar(255) NULL,
  `cpu_type` varchar(255) NULL,
  `filesystem` varchar(255) NULL,
  `hostname` varchar(255) NULL,
  `id` integer NOT NULL auto_increment,
  `osname` varchar(255) NOT NULL,
  `osversion` varchar(255) NULL,
  `variables`  NULL,
  INDEX `pk_id` (`id`),
  PRIMARY KEY (`id`)
) ENGINE=InnoDB;

--
-- Table: `test_outputs`
--
CREATE TABLE `test_outputs` (
  `build` varchar(255) NULL,
  `configure` varchar(255) NULL,
  `id` integer NOT NULL auto_increment,
  `install` varchar(255) NULL,
  `test` varchar(255) NULL,
  `uncategorized` varchar(255) NULL,
  INDEX `pk_id` (`id`),
  PRIMARY KEY (`id`)
) ENGINE=InnoDB comment=\'At least one of the properties must be set\';

--
-- Table: `uploads`
--
CREATE TABLE `uploads` (
  `author` varchar(255) NULL,
  `dist` varchar(255) NULL,
  `filename` varchar(255) NULL,
  `id` integer NOT NULL auto_increment,
  `released` datetime NULL,
  `version` varchar(255) NULL,
  INDEX `pk_id` (`id`),
  PRIMARY KEY (`id`)
) comment=\'A release to CPAN\';

SET foreign_key_checks=1;'
